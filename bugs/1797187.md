# 1797187

> https://bugs.launchpad.net/starlingx/+bug/1797187

## Virtual

### From compute-0

```
[wrsroot@controller-0 ~(keystone_admin)]$ ssh compute-0

WARNING: Unauthorized access to this system is forbidden and will be
prosecuted by law. By accessing this system, you agree that your
actions may be monitored if unauthorized usage is suspected.

compute-0:~$ 
```

```sh
compute-0:~$ grep GRUB_CMDLINE_LINUX /etc/default/grub
GRUB_CMDLINE_LINUX="security_profile=standard module_blacklist=integrity,ima audit=0 tboot=false crashkernel=auto biosdevname=0 console=ttyS0,115200 iommu=pt usbcore.autosuspend=-1 hugepagesz=2M hugepages=0 default_hugepagesz=2M isolcpus=1 rcu_nocbs=1-2 kthread_cpus=0 irqaffinity=0 selinux=0 enforcing=0 nmi_watchdog=panic,1 softlockup_panic=1 intel_iommu=on user_namespace.enable=1 nopti nospectre_v2"
```

```sh
compute-0:~$ mount | grep huge
cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)
none on /mnt/huge-2048kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/huge-2048kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/hugepages type hugetlbfs (rw,relatime,pagesize=2M)
```

```sh
compute-0:~$ ls /sys/kernel/mm/hugepages/
hugepages-2048kB
```

```sh
compute-0:~$ ls /sys/devices/system/node/
has_cpu  has_normal_memory  node0  online  possible  power  uevent
```

### From controller-0

```
[wrsroot@controller-0 ~(keystone_admin)]$ system host-list
+----+--------------+-------------+----------------+-------------+--------------+
| id | hostname     | personality | administrative | operational | availability |
+----+--------------+-------------+----------------+-------------+--------------+
| 1  | controller-0 | controller  | unlocked       | enabled     | available    |
| 2  | controller-1 | controller  | unlocked       | enabled     | available    |
| 4  | storage-1    | storage     | unlocked       | enabled     | available    |
| 5  | compute-0    | worker      | unlocked       | enabled     | available    |
| 7  | compute-1    | worker      | locked         | disabled    | online       |
| 8  | storage-0    | storage     | unlocked       | enabled     | available    |
| 9  | storage-2    | storage     | unlocked       | enabled     | available    |
| 11 | compute-2    | worker      | unlocked       | enabled     | available    |
+----+--------------+-------------+----------------+-------------+--------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-list compute-0
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| processor | mem_total(MiB) | mem_platform(MiB) | mem_avail(MiB) | hugepages(hp)_configured | vs_hp_size(MiB) | vs_hp_total | vs_hp_avail | vs_hp_reqd | vm_total_4K | vm_hp_total_2M | vm_hp_avail_2M | vm_hp_pending_2M | vm_hp_total_1G | vm_hp_avail_1G | vm_hp_pending_1G | vm_hp_use_1G |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| 0         | 7269           | 2500              | 7269           | True                     | 2               | 0           | 0           | None       | 1860864     | 0              | 0              | None             | 0              | None           | None             | False        |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-list compute-2
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+-------------+--------------+
| processor | mem_tot | mem_platfo | mem_ava | hugepages(hp)_ | vs_hp_ | vs_hp_ | vs_hp_ | vs_hp | vm_total | vm_hp_ | vm_hp_ | vm_hp_pe | vm_hp_ | vm_hp_ | vm_hp_pendi | vm_hp_use_1G |
|           | al(MiB) | rm(MiB)    | il(MiB) | configured     | size(M | total  | avail  | _reqd | _4K      | total_ | avail_ | nding_2M | total_ | avail_ | ng_1G       |              |
|           |         |            |         |                | iB)    |        |        |       |          | 2M     | 2M     |          | 1G     | 1G     |             |              |
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+-------------+--------------+
| 0         | 7269    | 2500       | 7269    | True           | 2      | 0      | 0      | None  | 1860864  | 0      | 0      | None     | 0      | None   | None        | False        |
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+-------------+--------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-show compute-0 0
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 7269                                 |
|         Platform     (MiB)          | 2500                                 |
|         Available    (MiB)          | 7269                                 |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 2                                    |
|                     Total           | 0                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1860864                              |
| Application  Huge Pages (2M): Total | 0                                    |
|                 Available           | 0                                    |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | None                                 |
| uuid                                | 6925a460-963a-4bba-8cf4-4d70b211c5aa |
| ihost_uuid                          | e2efc721-727f-4166-a2dd-9623dc8fa23b |
| inode_uuid                          | 22f30254-58a5-4bc5-9a14-2eeef74a597e |
| created_at                          | 2019-05-29T14:20:39.508894+00:00     |
| updated_at                          | 2019-05-30T04:53:53.950421+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-show compute-2 0
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 7269                                 |
|         Platform     (MiB)          | 2500                                 |
|         Available    (MiB)          | 7269                                 |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 2                                    |
|                     Total           | 0                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1860864                              |
| Application  Huge Pages (2M): Total | 0                                    |
|                 Available           | 0                                    |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | None                                 |
| uuid                                | ce66ec65-7bbb-4545-80cb-48736b9d07d1 |
| ihost_uuid                          | 7452c466-660d-4996-b29c-3619a170a588 |
| inode_uuid                          | 680ab2b3-dd58-44e5-a2c4-f8599bfcc5b5 |
| created_at                          | 2019-05-30T04:42:47.106046+00:00     |
| updated_at                          | 2019-05-30T05:09:32.766640+00:00     |
+-------------------------------------+--------------------------------------+
```

Work with compute-2

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-lock compute-2                                                                                                                                                                                                                                                                          
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-list
+----+--------------+-------------+----------------+-------------+--------------+
| id | hostname     | personality | administrative | operational | availability |
+----+--------------+-------------+----------------+-------------+--------------+
| 1  | controller-0 | controller  | unlocked       | enabled     | available    |
| 2  | controller-1 | controller  | unlocked       | enabled     | available    |
| 4  | storage-1    | storage     | unlocked       | enabled     | available    |
| 5  | compute-0    | worker      | unlocked       | enabled     | available    |
| 7  | compute-1    | worker      | locked         | disabled    | online       |
| 8  | storage-0    | storage     | unlocked       | enabled     | available    |
| 9  | storage-2    | storage     | unlocked       | enabled     | available    |
| 11 | compute-2    | worker      | locked         | disabled    | online       |
+----+--------------+-------------+----------------+-------------+--------------+
```

### Virtual 2M Hugepages

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-modify compute-2 0 -2M 10
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 7269                                 |
|         Platform     (MiB)          | 2500                                 |
|         Available    (MiB)          | 7269                                 |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 2                                    |
|                     Total           | 0                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1860864                              |
| Application  Huge Pages (2M): Total | 0                                    |
|                 Total Pending       | 10                                   |
|                 Available           | 0                                    |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | None                                 |
| uuid                                | ce66ec65-7bbb-4545-80cb-48736b9d07d1 |
| ihost_uuid                          | 7452c466-660d-4996-b29c-3619a170a588 |
| inode_uuid                          | 680ab2b3-dd58-44e5-a2c4-f8599bfcc5b5 |
| created_at                          | 2019-05-30T04:42:47.106046+00:00     |
| updated_at                          | 2019-05-30T05:13:09.449516+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-modify compute-2 0 -2M 512
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 7269                                 |
|         Platform     (MiB)          | 2500                                 |
|         Available    (MiB)          | 7269                                 |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 2                                    |
|                     Total           | 0                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1860864                              |
| Application  Huge Pages (2M): Total | 0                                    |
|                 Total Pending       | 512                                  |
|                 Available           | 0                                    |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | None                                 |
| uuid                                | ce66ec65-7bbb-4545-80cb-48736b9d07d1 |
| ihost_uuid                          | 7452c466-660d-4996-b29c-3619a170a588 |
| inode_uuid                          | 680ab2b3-dd58-44e5-a2c4-f8599bfcc5b5 |
| created_at                          | 2019-05-30T04:42:47.106046+00:00     |
| updated_at                          | 2019-05-30T05:17:01.329314+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-list compute-2
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+---------------+--------------+
| processor | mem_tot | mem_platfo | mem_ava | hugepages(hp)_ | vs_hp_ | vs_hp_ | vs_hp_ | vs_hp | vm_total | vm_hp_ | vm_hp_ | vm_hp_pe | vm_hp_ | vm_hp_ | vm_hp_pending | vm_hp_use_1G |
|           | al(MiB) | rm(MiB)    | il(MiB) | configured     | size(M | total  | avail  | _reqd | _4K      | total_ | avail_ | nding_2M | total_ | avail_ | _1G           |              |
|           |         |            |         |                | iB)    |        |        |       |          | 2M     | 2M     |          | 1G     | 1G     |               |              |
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+---------------+--------------+
| 0         | 7269    | 2500       | 7269    | True           | 2      | 0      | 0      | None  | 1860864  | 0      | 0      | 512      | 0      | None   | None          | False        |
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+---------------+--------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-show compute-2 0
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 7269                                 |
|         Platform     (MiB)          | 2500                                 |
|         Available    (MiB)          | 7269                                 |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 2                                    |
|                     Total           | 0                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1860864                              |
| Application  Huge Pages (2M): Total | 0                                    |
|                 Total Pending       | 512                                  |
|                 Available           | 0                                    |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | None                                 |
| uuid                                | ce66ec65-7bbb-4545-80cb-48736b9d07d1 |
| ihost_uuid                          | 7452c466-660d-4996-b29c-3619a170a588 |
| inode_uuid                          | 680ab2b3-dd58-44e5-a2c4-f8599bfcc5b5 |
| created_at                          | 2019-05-30T04:42:47.106046+00:00     |
| updated_at                          | 2019-05-30T05:18:27.065881+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-reboot compute-2
```

### Virtual 1G Hugepages

Modify kernel arguments and add:

```sh
hugepagessz=1G hugepages=0
```

Once booted

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-list
+----+--------------+-------------+----------------+-------------+--------------+
| id | hostname     | personality | administrative | operational | availability |
+----+--------------+-------------+----------------+-------------+--------------+
| 1  | controller-0 | controller  | unlocked       | enabled     | available    |
| 2  | controller-1 | controller  | unlocked       | enabled     | available    |
| 4  | storage-1    | storage     | unlocked       | enabled     | available    |
| 5  | compute-0    | worker      | unlocked       | enabled     | available    |
| 7  | compute-1    | worker      | locked         | disabled    | online       |
| 8  | storage-0    | storage     | unlocked       | enabled     | available    |
| 9  | storage-2    | storage     | unlocked       | enabled     | available    |
| 11 | compute-2    | worker      | locked         | disabled    | online       |
+----+--------------+-------------+----------------+-------------+--------------+
```

And online

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-list compute-2
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+---------------+--------------+
| processor | mem_tot | mem_platfo | mem_ava | hugepages(hp)_ | vs_hp_ | vs_hp_ | vs_hp_ | vs_hp | vm_total | vm_hp_ | vm_hp_ | vm_hp_pe | vm_hp_ | vm_hp_ | vm_hp_pending | vm_hp_use_1G |
|           | al(MiB) | rm(MiB)    | il(MiB) | configured     | size(M | total  | avail  | _reqd | _4K      | total_ | avail_ | nding_2M | total_ | avail_ | _1G           |              |
|           |         |            |         |                | iB)    |        |        |       |          | 2M     | 2M     |          | 1G     | 1G     |               |              |
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+---------------+--------------+
| 0         | 7269    | 2500       | 7269    | True           | 2      | 0      | 0      | None  | 1860864  | 0      | 0      | 512      | 0      | None   | None          | False        |
+-----------+---------+------------+---------+----------------+--------+--------+--------+-------+----------+--------+--------+----------+--------+--------+---------------+--------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-show compute-2 0
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 7269                                 |
|         Platform     (MiB)          | 2500                                 |
|         Available    (MiB)          | 7269                                 |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 2                                    |
|                     Total           | 0                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1860864                              |
| Application  Huge Pages (2M): Total | 0                                    |
|                 Total Pending       | 512                                  |
|                 Available           | 0                                    |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | None                                 |
| uuid                                | ce66ec65-7bbb-4545-80cb-48736b9d07d1 |
| ihost_uuid                          | 7452c466-660d-4996-b29c-3619a170a588 |
| inode_uuid                          | 680ab2b3-dd58-44e5-a2c4-f8599bfcc5b5 |
| created_at                          | 2019-05-30T04:42:47.106046+00:00     |
| updated_at                          | 2019-05-30T05:18:27.065881+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-modify compute-2 0 -1G 2
Processor 0:Processor does not support 1G huge pages.
```

Libvirt Configuration

```sh
user@workstation:~/stx-tools/deployment/libvirt$ sudo virsh edit extra-worker-0
Domain extra-worker-0 XML configuration edited.
```

```sh
<memoryBacking>
<hugepages/>
</memoryBacking>
```

```sh
user@workstation:~/stx-tools/deployment/libvirt$ sudo virsh start extra-worker-0
Domain extra-worker-0 started
```

```sh
linux16 /vmlinuz-3.10.0-957.1.3.el7.1.tis.x86_64 root=UUID=832b7504-96\
fa-47fe-a0e0-7ed7a09b90f7 ro security_profile=standard module_blacklist=integr\
ity,ima audit=0 tboot=false crashkernel=auto biosdevname=0 console=ttyS0,11520\
0 iommu=pt usbcore.autosuspend=-1 selinux=0 enforcing=0 nmi_watchdog=panic,1 s\
oftlockup_panic=1 intel_iommu=on user_namespace.enable=1 hugepagesz=2M hugepag\
es=0 hugepagesz=1G hugepages=0 default_hugepagesz=2M irqaffinity=0 rcu_nocbs=1\
-3 kthread_cpus=0 nopti nospectre_v2
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-list
+----+--------------+-------------+----------------+-------------+--------------+
| id | hostname     | personality | administrative | operational | availability |
+----+--------------+-------------+----------------+-------------+--------------+
| 1  | controller-0 | controller  | unlocked       | enabled     | available    |
| 2  | controller-1 | controller  | unlocked       | enabled     | available    |
| 4  | storage-1    | storage     | unlocked       | enabled     | available    |
| 5  | compute-0    | worker      | unlocked       | enabled     | available    |
| 7  | compute-1    | worker      | locked         | disabled    | online       |
| 8  | storage-0    | storage     | unlocked       | enabled     | available    |
| 9  | storage-2    | storage     | unlocked       | enabled     | available    |
| 11 | compute-2    | worker      | locked         | disabled    | online       |
+----+--------------+-------------+----------------+-------------+--------------+
```

```sh
[wrsroot@controller-0 ~(keystone_admin)]$ system host-memory-list compute-2
+-----------+---------+------------+---------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| processor | mem_tot | mem_platfo | mem_ava | hugepages(hp)_configured | vs_hp_size(MiB) | vs_hp_total | vs_hp_avail | vs_hp_reqd | vm_total_4K | vm_hp_total_2M | vm_hp_avail_2M | vm_hp_pending_2M | vm_hp_total_1G | vm_hp_avail_1G | vm_hp_pending_1G | vm_hp_use_1G |
|           | al(MiB) | rm(MiB)    | il(MiB) |                          |                 |             |             |            |             |                |                |                  |                |                |                  |              |
+-----------+---------+------------+---------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| 0         | 7269    | 2500       | 7269    | True                     | 2               | 0           | 0           | None       | 1860864     | 0              | 0              | 512              | 0              | None           | None             | False        |
+-----------+---------+------------+---------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
```

## Bare Metal

```
[wrsroot@controller-1 ~(keystone_admin)]$ cat /etc/build.info 
###
### StarlingX
###     Built from master
###

OS="centos"
SW_VERSION="19.01"
BUILD_TARGET="Host Installer"
BUILD_TYPE="Formal"
BUILD_ID="20190521T132734Z"

JOB="STX_build_master_master"
BUILD_BY="starlingx.build@cengn.ca"
BUILD_NUMBER="111"
BUILD_HOST="starlingx_mirror"
BUILD_DATE="2019-05-21 13:27:34 +0000"
```

### From controller-1

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-list
+----+--------------+-------------+----------------+-------------+--------------+
| id | hostname     | personality | administrative | operational | availability |
+----+--------------+-------------+----------------+-------------+--------------+
| 2  | compute-0    | worker      | locked         | disabled    | online       |
| 3  | compute-1    | worker      | unlocked       | disabled    | offline      |
| 4  | controller-1 | controller  | unlocked       | enabled     | available    |
| 5  | storage-0    | storage     | locked         | disabled    | online       |
| 6  | storage-1    | storage     | locked         | disabled    | online       |
| 7  | storage-2    | storage     | locked         | disabled    | online       |
| 12 | None         | None        | locked         | disabled    | offline      |
+----+--------------+-------------+----------------+-------------+--------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-list compute-0
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| processor | mem_total(MiB) | mem_platform(MiB) | mem_avail(MiB) | hugepages(hp)_configured | vs_hp_size(MiB) | vs_hp_total | vs_hp_avail | vs_hp_reqd | vm_total_4K | vm_hp_total_2M | vm_hp_avail_2M | vm_hp_pending_2M | vm_hp_total_1G | vm_hp_avail_1G | vm_hp_pending_1G | vm_hp_use_1G |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| 0         | 85978          | 8000              | 84954          | True                     | 1024            | 1           | 0           | None       | 0           | 42477          | 42477          | None             | 0              | 0              | None             | True         |
| 1         | 93979          | 2000              | 92955          | True                     | 1024            | 1           | 0           | None       | 1660672     | 43234          | 43234          | None             | 0              | 0              | None             | True         |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
```

### Bare Metal 2M Huge Pages

What are the default 2M huge pages values?

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-list compute-1
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| processor | mem_total(MiB) | mem_platform(MiB) | mem_avail(MiB) | hugepages(hp)_configured | vs_hp_size(MiB) | vs_hp_total | vs_hp_avail | vs_hp_reqd | vm_total_4K | vm_hp_total_2M | vm_hp_avail_2M | vm_hp_pending_2M | vm_hp_total_1G | vm_hp_avail_1G | vm_hp_pending_1G | vm_hp_use_1G |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| 0         | 86088          | 8000              | 85064          | True                     | 1024            | 1           | 0           | None       | 26624       | 42480          | 42480          | None             | 0              | 0              | None             | True         |
| 1         | 94050          | 2000              | 93026          | True                     | 1024            | 1           | 0           | None       | 1679872     | 43232          | 43232          | None             | 0              | 0              | None             | True         |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 0 -2M 42477
Processor 0:No available space for 1G vswitch huge page allocation, max 1G vswitch pages: 0
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 1 -2M 43232
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 93979                                |
|         Platform     (MiB)          | 2000                                 |
|         Available    (MiB)          | 92955                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1660672                              |
| Application  Huge Pages (2M): Total | 43234                                |
|                 Total Pending       | 43232                                |
|                 Available           | 43234                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | 0                                    |
| uuid                                | 5253dace-d2e6-489f-833c-c67ebab1583e |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 6f0cc340-8f5f-40a6-88e0-fabb90ba9a91 |
| created_at                          | 2019-05-22T14:30:51.989345+00:00     |
| updated_at                          | 2019-05-30T07:14:24.821020+00:00     |
+-------------------------------------+--------------------------------------+
```

Decreasing to 512 2M huge pages

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 0 -2M 512
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 85978                                |
|         Platform     (MiB)          | 8000                                 |
|         Available    (MiB)          | 84954                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 0                                    |
| Application  Huge Pages (2M): Total | 42477                                |
|                 Total Pending       | 512                                  |
|                 Available           | 42477                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | 0                                    |
| uuid                                | 44e7e9f3-7405-4c15-87d4-63fd4cdc7b5f |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 7bbaa8f0-ca2a-4861-9072-2081c7bfc627 |
| created_at                          | 2019-05-22T14:30:51.956381+00:00     |
| updated_at                          | 2019-05-29T12:20:54.203705+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 1 -2M 512
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 93979                                |
|         Platform     (MiB)          | 2000                                 |
|         Available    (MiB)          | 92955                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1660672 [wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-list compute-0
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| processor | mem_total(MiB) | mem_platform(MiB) | mem_avail(MiB) | hugepages(hp)_configured | vs_hp_size(MiB) | vs_hp_total | vs_hp_avail | vs_hp_reqd | vm_total_4K | vm_hp_total_2M | vm_hp_avail_2M | vm_hp_pending_2M | vm_hp_total_1G | vm_hp_avail_1G | vm_hp_pending_1G | vm_hp_use_1G |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| 0         | 85978          | 8000              | 84954          | True                     | 1024            | 1           | 0           | None       | 0           | 42477          | 42477          | 512              | 0              | 0              | None             | True         |
| 1         | 93979          | 2000              | 92955          | True                     | 1024            | 1           | 0           | None       | 1660672     | 43234          | 43234          | 512              | 0              | 0              | None             | True         |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
                             |
| Application  Huge Pages (2M): Total | 43234                                |
|                 Total Pending       | 512                                  |
|                 Available           | 43234                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Available           | 0                                    |
| uuid                                | 5253dace-d2e6-489f-833c-c67ebab1583e |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 6f0cc340-8f5f-40a6-88e0-fabb90ba9a91 |
| created_at                          | 2019-05-22T14:30:51.989345+00:00     |
| updated_at                          | 2019-05-30T07:16:33.322895+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-list compute-0
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| processor | mem_total(MiB) | mem_platform(MiB) | mem_avail(MiB) | hugepages(hp)_configured | vs_hp_size(MiB) | vs_hp_total | vs_hp_avail | vs_hp_reqd | vm_total_4K | vm_hp_total_2M | vm_hp_avail_2M | vm_hp_pending_2M | vm_hp_total_1G | vm_hp_avail_1G | vm_hp_pending_1G | vm_hp_use_1G |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| 0         | 85978          | 8000              | 84954          | True                     | 1024            | 1           | 0           | None       | 0           | 42477          | 42477          | 512              | 0              | 0              | None             | True         |
| 1         | 93979          | 2000              | 92955          | True                     | 1024            | 1           | 0           | None       | 1660672     | 43234          | 43234          | 512              | 0              | 0              | None             | True         |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+compute-0:~$ mount | grep huge
cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)
none on /dev/huge-2048kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/huge-1048576kB type hugetlbfs (rw,relatime,pagesize=1048576kB)
none on /mnt/huge-1048576kB type hugetl8kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/huge-1048576kB type hugetlbfs (rw,relatime,pagesize=1048576kB)
none on /mnt/huge-1048576kB type hugetlbfs (rw,relatime,pagesize=1048576kB)
none on /mnt/huge-2048kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/hugepages type hugetlbfs (rw,relatime,pagesize=2M)
compute-0bfs (rw,relatime,pagesize=1048576kB)
none on /mnt/huge-2048kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/hugepages type hugetlbfs (rw,relatime,pagesize=2M)
compute-0:~$ 

```

Going back to default 2M huge pages values

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 0 -2M 42477
Processor 0:No available space for 1G vswitch huge page allocation, max 1G vswitch pages: 0
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 1 -2M 43232 
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 93979                                |
|         Platform     (MiB)          | 2000                                 |
|         Available    (MiB)          | 92955                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 1660672                              |
| Application  Huge Pages (2M): Total | 43234                                |
|                 Total Pending       | 43232                                |
|                 Available           | 43234                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Acompute-0:~$ ls /sys/kernel/mm/hugepages/
hugepages-1048576kB  hugepages-2048kB
compute-0:~$ ls /sys/devices/system/node/
has_cpu  has_normal_memory  node0  node1  online  possible  power  uevent
vailable           | 0                                    |
| uuid                                | 5253dace-d2e6-489f-833c-c67ebab1583e |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 6f0cc340-8f5f-40a6-88e0-fabb90ba9a91 |
| created_at                          | 2019-05-22T14:30:51.989345+00:00     |
| updated_at                          | 2019-05-30T07:18:47.001332+00:00     |
+-------------------------------------+--------------------------------------+
```

### Bare Metal 1G Hugepages

### From compute-0

```sh
WARNING: Unauthorized access to this system is forbidden and will be
prosecuted by law. By accessing this system, you agree that your
actions may be monitored if unauthorized usage is suspected.

compute-0:~$ grep GRUB_CMDLINE_LINUX /etc/default/grub
GRUB_CMDLINE_LINUX="security_profile=standard module_blacklist=integrity,ima audit=0 tboot=false crashkernel=auto biosdevname=0 console=ttyS0,115200 iommu=pt usbcore.autosuspend=-1 hugepagesz=2M hugepages=0 default_hugepagesz=2M isolcpus=1,57,2,58 rcu_nocbs=1-55,57-111 kthread_cpus=0,56 irqaffinity=0,56 selinux=0 enforcing=0 nmi_watchdog=panic,1 softlockup_panic=1 intel_iommu=on user_namespace.enable=1 nopti nospectre_v2"
compute-0:~$ 
```

compute-0 kernel boot arguments

```sh
compute-0:~$ cat /proc/cmdline 
BOOT_IMAGE=/vmlinuz-3.10.0-957.1.3.el7.1.tis.x86_64 root=UUID=99acf4a8-62c8-4b35-a58e-db6b0dea002f ro security_profile=standard module_blacklist=integrity,ima audit=0 tboot=false crashkernel=auto biosdevname=0 console=ttyS0,115200 iommu=pt usbcore.autosuspend=-1 selinux=0 enforcing=0 nmi_watchdog=panic,1 softlockup_panic=1 intel_iommu=on user_namespace.enable=1 hugepagesz=1G hugepages=2 nopti nospectre_v2 hugepagesz=2M hugepages=0 default_hugepagesz=2M irqaffinity=0,56 rcu_nocbs=1-55,57-111 isolcpus=1-2,57-58 kthread_cpus=0,56
```

```sh
compute-0:~$ grep GRUB_CMDLINE_LINUX /etc/default/grub
GRUB_CMDLINE_LINUX="security_profile=standard module_blacklist=integrity,ima audit=0 tboot=false crashkernel=auto biosdevname=0 console=ttyS0,115200 iommu=pt usbcore.autosuspend=-1 hugepagesz=2M hugepages=0 default_hugepagesz=2M isolcpus=1,57,2,58 rcu_nocbs=1-55,57-111 kthread_cpus=0,56 irqaffinity=0,56 selinux=0 enforcing=0 nmi_watchdog=panic,1 softlockup_panic=1 intel_iommu=on user_namespace.enable=1 nopti nospectre_v2"
compute-0:~$ 
```

```sh
compute-0:~$ cat /proc/meminfo  | grep Huge
HugePages_Total:   43744
HugePages_Free:    43744
HugePages_Rsvd:        0
HugePages_Surp:        0
Hugepagesize:       2048 kB
```

```sh
linuxefi /vmlinuz-3.10.0-957.1.3.el7.1.tis.x86_64 root=UUID=99acf4a8-62c8-4b35-a58e-db6b0dea002f ro security_profile=standard module_blacklist=integrity,ima audit=0 tboot=false crashkernel=auto biosdevname=0 console=ttyS0,115200 iommu=pt usbcore.autosuspend=-1 selinux=0 enforcing=0 nmi_watchdog=panic,1 softlockup_panic=1 intel_iommu=on user_namespace.enable=1 hugepagesz=1G hugep
```

```sh
compute-0:~$ ls /sys/kernel/mm/hugepages/
hugepages-1048576kB  hugepages-2048kB
```

```sh
compute-0:~$ ls /sys/devices/system/node/
has_cpu  has_normal_memory  node0  node1  online  possible  power  uevent
ages=2 nopti nospectre_v2 hugepagesz=2M hugepages=0 default_hugepagesz=2M irqaffinity=0,56 rcu_nocbs=1-55,57-111 isolcpus=1-2,57-58 kthread_cpus=0,56         
```

```sh
compute-0:~$ mount | grep huge
cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)
none on /dev/huge-2048kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/huge-1048576kB type hugetlbfs (rw,relatime,pagesize=1048576kB)
none on /mnt/huge-1048576kB type hugetl8kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/huge-1048576kB type hugetlbfs (rw,relatime,pagesize=1048576kB)
none on /mnt/huge-1048576kB type hugetlbfs (rw,relatime,pagesize=1048576kB)
none on /mnt/huge-2048kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/hugepages type hugetlbfs (rw,relatime,pagesize=2M)
compute-0bfs (rw,relatime,pagesize=1048576kB)
none on /mnt/huge-2048kB type hugetlbfs (rw,relatime,pagesize=2048kB)
none on /dev/hugepages type hugetlbfs (rw,relatime,pagesize=2M)
compute-0:~$ 
```

```sh
compute-0:~$ ls /sys/kernel/mm/hugepages/
hugepages-1048576kB  hugepages-2048kB
```

```sh
compute-0:~$ ls /sys/devices/system/node/
has_cpu  has_normal_memory  node0  node1  online  possible  power  uevent
```

### From controller-0

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 0 -1G 1
Processor 0:No available space for new VM hugepage settings.Max 1G pages is 0 when 2M is 42477, or Max 2M pages is 39966 when 1G is 5.
```

Reboot!

```sh
        linuxefi /vmlinuz-3.10.0-957.1.3.el7.1.tis.x86_64 root=UUID=99acf4a8-62c8-4b35-a58e-db6b0dea002f ro security_profile=standard module_blacklist=integrity,ima audit=0 tboot=false crashkernel=auto biosdevname=0 console=ttyS0,115200 iommu=pt usbcore.autosuspend=-1 selinux=0 enforcing=0 nmi_watchdog=panic,1 softlockup_panic=1 intel_iommu=on user_namespace.enable=1 hugepagesz=1G hugepages=2 nopti nospectre_v2 hugepagesz=2M hugepages=0 default_hugepagesz=2M irqaffinity=0,56 rcu_nocbs=1-55,57-111 isolcpus=1-2,57-58 kthread_cpus=0,56
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 0 -1G 1
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 85978                                |
|         Platform     (MiB)          | 8000                                 |
|         Available    (MiB)          | 84954                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 0                                    |
| Application  Huge Pages (2M): Total | 42477                                |
|                 Total Pending       | 512                                  |
|                 Available           | 42477                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Total Pending       | 1                                    |
|                 Available           | 0                                    |
| uuid                                | 44e7e9f3-7405-4c15-87d4-63fd4cdc7b5f |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 7bbaa8f0-ca2a-4861-9072-2081c7bfc627 |
| created_at                          | 2019-05-22T14:30:51.956381+00:00     |
| updated_at                          | 2019-05-30T07:15:26.179930+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 0 -1G 2
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 85978                                |
|         Platform     (MiB)          | 8000                                 |
|         Available    (MiB)          | 84954                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 0                                    |
| Application  Huge Pages (2M): Total | 42477                                |
|                 Total Pending       | 512                                  |
|                 Available           | 42477                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Total Pending       | 2                                    |
|                 Available           | 0                                    |
| uuid                                | 44e7e9f3-7405-4c15-87d4-63fd4cdc7b5f |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 7bbaa8f0-ca2a-4861-9072-2081c7bfc627 |
| created_at                          | 2019-05-22T14:30:51.956381+00:00     |
| updated_at                          | 2019-05-30T08:04:03.395857+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-list compute-0
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| processor | mem_total(MiB) | mem_platform(MiB) | mem_avail(MiB) | hugepages(hp)_configured | vs_hp_size(MiB) | vs_hp_total | vs_hp_avail | vs_hp_reqd | vm_total_4K | vm_hp_total_2M | vm_hp_avail_2M | vm_hp_pending_2M | vm_hp_total_1G | vm_hp_avail_1G | vm_hp_pending_1G | vm_hp_use_1G |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
| 0         | 85978          | 8000              | 84954          | True                     | 1024            | 1           | 0           | None       | 0           | 42477          | 42477          | 512              | 0              | 0              | 2                | True         |
| 1         | 93979          | 2000              | 92955          | True                     | 1024            | 1           | 0           | None       | 1660672     | 43234          | 43234          | 43232            | 0              | 0              | None             | True         |
+-----------+----------------+-------------------+----------------+--------------------------+-----------------+-------------+-------------+------------+-------------+----------------+----------------+------------------+----------------+----------------+------------------+--------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-show compute-0 0
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 85978                                |
|         Platform     (MiB)          | 8000                                 |
|         Available    (MiB)          | 84954                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 0                                    |
| Application  Huge Pages (2M): Total | 42477                                |
|                 Total Pending       | 512                                  |
|                 Available           | 42477                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Total Pending       | 2                                    |
|                 Available           | 0                                    |
| uuid                                | 44e7e9f3-7405-4c15-87d4-63fd4cdc7b5f |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 7bbaa8f0-ca2a-4861-9072-2081c7bfc627 |
| created_at                          | 2019-05-22T14:30:51.956381+00:00     |
| updated_at                          | 2019-05-30T08:04:07.003846+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 0 -1G 10
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 85978                                |
|         Platform     (MiB)          | 8000                                 |
|         Available    (MiB)          | 84954                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 0                                    |
| Application  Huge Pages (2M): Total | 42477                                |
|                 Total Pending       | 512                                  |
|                 Available           | 42477                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Total Pending       | 10                                   |
|                 Available           | 0                                    |
| uuid                                | 44e7e9f3-7405-4c15-87d4-63fd4cdc7b5f |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 7bbaa8f0-ca2a-4861-9072-2081c7bfc627 |
| created_at                          | 2019-05-22T14:30:51.956381+00:00     |
| updated_at                          | 2019-05-30T08:07:56.020619+00:00     |
+-------------------------------------+--------------------------------------+
```

Second reboot...

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-show compute-0 0
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 85978                                |
|         Platform     (MiB)          | 8000                                 |
|         Available    (MiB)          | 84954                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | None                                 |
| Application  Pages (4K): Total      | 0                                    |
| Application  Huge Pages (2M): Total | 42477                                |
|                 Total Pending       | 512                                  |
|                 Available           | 42477                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Total Pending       | 10                                   |
|                 Available           | 0                                    |
| uuid                                | 44e7e9f3-7405-4c15-87d4-63fd4cdc7b5f |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 7bbaa8f0-ca2a-4861-9072-2081c7bfc627 |
| created_at                          | 2019-05-22T14:30:51.956381+00:00     |
| updated_at                          | 2019-05-30T08:08:01.097242+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-show compute-0 0
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 85978                                |
|         Platform     (MiB)          | 8000                                 |
|         Available    (MiB)          | 84954                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | 1                                    |
| Application  Pages (4K): Total      | 0                                    |
| Application  Huge Pages (2M): Total | 42477                                |
|                 Total Pending       | 512                                  |
|                 Available           | 42477                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Total Pending       | 10                                   |
|                 Available           | 0                                    |
| uuid                                | 44e7e9f3-7405-4c15-87d4-63fd4cdc7b5f |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 7bbaa8f0-ca2a-4861-9072-2081c7bfc627 |
| created_at                          | 2019-05-22T14:30:51.956381+00:00     |
| updated_at                          | 2019-05-30T08:13:46.709268+00:00     |
+-------------------------------------+--------------------------------------+
```

```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 0 -1G 5
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 85978                                |
|         Platform     (MiB)          | 8000                                 |
|         Available    (MiB)          | 84954                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | 1                                    |
| Application  Pages (4K): Total      | 0                                    |
| Application  Huge Pages (2M): Total | 42477                                |
|                 Total Pending       | 512                                  |
|                 Available           | 42477                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Total Pending       | 5                                    |
|                 Available           | 0                                    |
| uuid                                | 44e7e9f3-7405-4c15-87d4-63fd4cdc7b5f |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 7bbaa8f0-ca2a-4861-9072-2081c7bfc627 |
| created_at                          | 2019-05-22T14:30:51.956381+00:00     |
| updated_at                          | 2019-05-30T08:46:41.368717+00:00     |
+-------------------------------------+--------------------------------------+
```
```sh
[wrsroot@controller-1 ~(keystone_admin)]$ system host-memory-modify compute-0 1 -1G 5
+-------------------------------------+--------------------------------------+
| Property                            | Value                                |
+-------------------------------------+--------------------------------------+
| Memory: Usable Total (MiB)          | 93979                                |
|         Platform     (MiB)          | 2000                                 |
|         Available    (MiB)          | 92955                                |
| Huge Pages Configured               | True                                 |
| vSwitch Huge Pages: Size (MiB)      | 1024                                 |
|                     Total           | 1                                    |
|                     Available       | 0                                    |
|                     Required        | 1                                    |
| Application  Pages (4K): Total      | 1660672                              |
| Application  Huge Pages (2M): Total | 43234                                |
|                 Total Pending       | 43232                                |
|                 Available           | 43234                                |
| Application  Huge Pages (1G): Total | 0                                    |
|                 Total Pending       | 5                                    |
|                 Available           | 0                                    |
| uuid                                | 5253dace-d2e6-489f-833c-c67ebab1583e |
| ihost_uuid                          | 4ea97f9a-d169-4009-aad7-5c5c2208c5da |
| inode_uuid                          | 6f0cc340-8f5f-40a6-88e0-fabb90ba9a91 |
| created_at                          | 2019-05-22T14:30:51.989345+00:00     |
| updated_at                          | 2019-05-30T08:47:10.828852+00:00     |
+-------------------------------------+--------------------------------------+
```
